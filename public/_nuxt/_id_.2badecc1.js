import{_ as ne}from"./back.b5851195.js";import{_ as se}from"./status-block.5ad685de.js";import{i as H}from"./import-icon.de3e6c66.js";import{a as vo,u as ko,k as $,g as G,h as u,c as z,i as ie,b as ae,f as K,_ as no,t as co}from"./pool.0a9aff1a.js";import{a as Io,J as bo,r as p,f as _,h as ho,o as c,i as k,j as n,v as w,x as y,u as r,t as a,l as Q,k as W,S as Eo,p as go,m as wo,M as te,H as le,c as fo,s as U,B as Do,w as eo,a0 as re,b as de,G as ue,X as M,a1 as Bo,z as me,A as pe,E as ce,F as fe,D as ve}from"./entry.cb6f389e.js";/* empty css              */import{_ as qo,a as Fo}from"./icon-arrow_2x.45808d19.js";import{_ as ke}from"./apr-tab.58ee03f0.js";import{_ as Ie}from"./apr-tips.954ebdc3.js";/* empty css              */import{p as be}from"./precision.a7a6c57b.js";/* empty css              */import"./index.36e591b5.js";const he=Io({props:{positionInfo:{type:Object,required:!0,default:()=>({})}},setup(o){const{t:f}=bo();let j=p(!1),J=p(!0);const h=vo(),b=ko(),m=_(()=>b);console.log(o.positionInfo,"===>props.positionInfo");const I=_(()=>{var N,C,A,S,i,E,e,v;if(z(o.positionInfo))return" --";{const D=o.positionInfo.amountA*((C=m.value.RATES[(N=o.positionInfo)==null?void 0:N.token_a.address])==null?void 0:C.price),q=o.positionInfo.amountB*((S=m.value.RATES[(A=o.positionInfo)==null?void 0:A.token_b.address])==null?void 0:S.price);return(E=m.value.RATES[(i=o.positionInfo)==null?void 0:i.token_a.address])!=null&&E.price&&((v=m.value.RATES[(e=o.positionInfo)==null?void 0:e.token_b.address])!=null&&v.price)?D+q:" --"}}),g=_(()=>{var N,C,A,S;return(C=m.value.RATES[(N=o.positionInfo)==null?void 0:N.token_a.name.toUpperCase()])!=null&&C.price&&I.value!=="--"?(o.positionInfo.amountA*((S=m.value.RATES[(A=o.positionInfo)==null?void 0:A.token_a.name.toUpperCase()])==null?void 0:S.price)/I.value*100).toFixed(0):" --"}),L=_(()=>{var N,C,A,S;return(C=m.value.RATES[(N=o.positionInfo)==null?void 0:N.token_b.name.toUpperCase()])!=null&&C.price&&I.value!=="--"?(o.positionInfo.amountB*((S=m.value.RATES[(A=o.positionInfo)==null?void 0:A.token_b.name.toUpperCase()])==null?void 0:S.price)/I.value*100).toFixed(0):" --"}),B=_(()=>m.value.allTokenObj&&o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.address&&m.value.allTokenObj[o.positionInfo.token_a.address]&&m.value.allTokenObj[o.positionInfo.token_a.address].logoURI),V=_(()=>m.value.allTokenObj&&o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.address&&m.value.allTokenObj[o.positionInfo.token_b.address]&&m.value.allTokenObj[o.positionInfo.token_b.address].logoURI);return console.log(o.positionInfo,"===>positionInfo"),{fromPercent:L,toPercent:g,amountUSD:I,showNum:$,t:f,importIcon:H,indexStore:h,rateChange:J,decimalFormat:G,fromCoinUrl:B,toCoinUrl:V,pools:m,addCommom:u,isPc:j}}});const ge=o=>(go("data-v-62011ebe"),o=o(),wo(),o),we={key:0,class:"position-card"},_e={class:"coin-pair"},ye=["src"],$e=["src"],Ce={class:"fee"},Te={class:"right"},Ae={key:0,class:"status"},Se={class:"min-and-max"},Re={key:0},Oe={class:"text"},Ne={key:0,src:qo,alt:""},Pe={key:1,src:Fo,alt:""},Ue={class:"text"},je={key:1},Le={class:"text"},Be={key:0,src:qo,alt:""},Ee={key:1,src:Fo,alt:""},De={class:"text"},qe=ge(()=>n("use",{"xlink:href":"#icon-a-icon-change2"},null,-1)),Fe=[qe],We={class:"liquidity"},He={class:"label"},Me={class:"value"},ze={class:"token-num"},Ge={class:"item"},Je=["src"],Xe={class:"rate"},Ke={class:"item"},Qe=["src"],Ye={class:"rate"};function Ze(o,f,j,J,h,b){const m=Eo,I=se;return o.positionInfo?(c(),k("div",we,[n("div",{class:Q(["left",`position-status-${o.positionInfo&&o.positionInfo.currentStatus&&o.positionInfo.currentStatus.toLowerCase()}`])},[w(m,{class:"left-skeleton",loading:o.pools.currentPositionLoading,active:"",paragraph:!1},{default:y(()=>[n("div",_e,[n("div",null,[n("img",{src:o.fromCoinUrl||("importIcon"in o?o.importIcon:r(H))(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,ye),n("img",{src:o.toCoinUrl||("importIcon"in o?o.importIcon:r(H))(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,$e)]),n("span",null,a(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol)+" - "+a(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol),1)]),n("div",Ce,a(o.$t("common.fee"))+" "+a(o.positionInfo.fee*100)+"%",1)]),_:1},8,["loading"])],2),n("div",Te,[o.pools.currentPositionLoading?W("",!0):(c(),k("div",Ae,[w(I,{"current-status":o.positionInfo.currentStatus||"","block-name":"detail"},null,8,["current-status"])])),w(m,{loading:o.pools.currentPositionLoading,active:"",paragraph:!1},{default:y(()=>[n("div",Se,[o.rateChange?(c(),k("div",Re,[n("div",Oe,a(("addCommom"in o?o.addCommom:r(u))(("decimalFormat"in o?o.decimalFormat:r(G))(String(o.positionInfo.minPrice),6))),1),o.indexStore.theme=="default"?(c(),k("img",Ne)):(c(),k("img",Pe)),n("div",Ue,a(o.positionInfo&&o.positionInfo.maxPrice&&o.positionInfo.maxPrice.indexOf("∞")>-1||o.positionInfo&&o.positionInfo.maxPrice&&o.positionInfo.maxPrice.indexOf("+")>-1?"∞":("addCommom"in o?o.addCommom:r(u))(("decimalFormat"in o?o.decimalFormat:r(G))(String(o.positionInfo.maxPrice),6)))+" "+a(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol)+" per "+a(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol),1)])):(c(),k("div",je,[n("div",Le,a(("addCommom"in o?o.addCommom:r(u))(("decimalFormat"in o?o.decimalFormat:r(G))(String(1/Number(o.positionInfo.maxPrice)),6))),1),o.indexStore.theme=="default"?(c(),k("img",Be)):(c(),k("img",Ee)),n("div",De,a(o.positionInfo&&o.positionInfo.maxPrice&&o.positionInfo.maxPrice.indexOf("∞")>-1||o.positionInfo&&o.positionInfo.maxPrice&&o.positionInfo.maxPrice.indexOf("+")>-1?"∞":("addCommom"in o?o.addCommom:r(u))(("decimalFormat"in o?o.decimalFormat:r(G))(String(1/Number(o.positionInfo.minPrice)),6),6))+" "+a(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol)+" per "+a(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol),1)])),(c(),k("svg",{class:"icon-change","aria-hidden":"true",onClick:f[0]||(f[0]=g=>o.rateChange=!o.rateChange)},Fe))])]),_:1},8,["loading"]),n("div",We,[w(m,{loading:o.pools.currentPositionLoading,active:"",paragraph:!1},{default:y(()=>[n("div",He,a(o.$t("common.liquidity")),1),n("div",Me," $"+a(o.amountUSD=="--"?"--":Number(o.amountUSD)==0?0:Number(o.amountUSD)<.01?"<0.01":("addCommom"in o?o.addCommom:r(u))(o.amountUSD,2)),1)]),_:1},8,["loading"])]),n("div",ze,[w(m,{loading:o.pools.currentPositionLoading,active:"",paragraph:!1},{default:y(()=>[n("div",Ge,[n("div",null,[n("img",{src:o.fromCoinUrl||("importIcon"in o?o.importIcon:r(H))(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,Je),n("p",null,a(("showNum"in o?o.showNum:r($))(o.positionInfo&&o.positionInfo.amountA,o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals)),1),n("span",null,a(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol)+" "+a(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.labels&&o.positionInfo.token_a.labels[0]?`(${o.positionInfo.token_a.labels[0]})`:""),1)]),n("div",Xe,a(("addCommom"in o?o.addCommom:r(u))(o.positionInfo.fromPercent,0))+"% ",1)]),n("div",Ke,[n("div",null,[n("img",{src:o.toCoinUrl||("importIcon"in o?o.importIcon:r(H))(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,Qe),n("p",null,a(("showNum"in o?o.showNum:r($))(o.positionInfo&&o.positionInfo.amountB,o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals)),1),n("span",null,a(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_b.symbol)+" "+a(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.labels&&o.positionInfo.token_b.labels[0]?`(${o.positionInfo.token_b.labels[0]})`:""),1)]),n("div",Ye,a(("addCommom"in o?o.addCommom:r(u))(o.positionInfo.toPercent,0))+"%",1)])]),_:1},8,["loading"])])])])):W("",!0)}const Ve=ho(he,[["render",Ze],["__scopeId","data-v-62011ebe"]]),xe=Io({components:{Modal:te},props:{positionInfo:{type:Object,required:!0},isLoading:{type:Boolean,required:!0}},setup(o,f){const{t:j,locale:J}=bo(),h=vo(),{copy:b}=h,m=()=>{f.emit("toClaim")},I=ko(),g=_(()=>I),L=_(()=>g.value.tokensObj&&o.positionInfo.token_a.address&&g.value.tokensObj[o.positionInfo.token_a.address]&&g.value.tokensObj[o.positionInfo.token_a.address].logoURI),B=_(()=>g.value.tokensObj&&o.positionInfo.token_b.address&&g.value.tokensObj[o.positionInfo.token_b.address]&&g.value.tokensObj[o.positionInfo.token_b.address].logoURI);return{showNum:$,fromCoinUrl:L,toCoinUrl:B,toClaim:m,t:j,addCommom:u,importIcon:H,store:h,copy:b}}});const on=o=>(go("data-v-39d55de9"),o=o(),wo(),o),en=on(()=>n("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),nn={class:"claim-container"},sn={key:0,class:"pc-claim"},an=["src"],tn={key:1,class:"pc-claim"},ln=["src"];function rn(o,f,j,J,h,b){const m=Do,I=le("Modal");return c(),fo(I,{visible:!0,class:"claim-fees",centered:"",closable:!0,title:o.$t("modal.claimFees"),width:"400px",footer:null,onCancel:f[0]||(f[0]=g=>o.$emit("onClose"))},{closeIcon:y(()=>[en]),default:y(()=>[n("div",nn,[o.positionInfo&&o.positionInfo.token_a.symbol?(c(),k("div",sn,[n("img",{src:o.fromCoinUrl||("importIcon"in o?o.importIcon:r(H))(`/image/coins/${o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,an),n("span",null,a(("showNum"in o?o.showNum:r($))(o.positionInfo.feeOwedA,o.positionInfo.token_a.decimals))+" "+a(o.positionInfo.token_a.symbol),1)])):W("",!0),o.positionInfo&&o.positionInfo.token_b.symbol?(c(),k("div",tn,[n("img",{src:o.toCoinUrl||("importIcon"in o?o.importIcon:r(H))(`/image/coins/${o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,ln),n("span",null,a(("showNum"in o?o.showNum:r($))(o.positionInfo.feeOwedB,o.positionInfo.token_b.decimals))+" "+a(o.positionInfo.token_b.symbol),1)])):W("",!0)]),w(m,{class:"big-btn claim-btn",disabled:o.isLoading||("addCommom"in o?o.addCommom:r(u))(o.positionInfo.feeOwedA,o.positionInfo.token_a.decimals)==0&&("addCommom"in o?o.addCommom:r(u))(o.positionInfo.feeOwedB,o.positionInfo.token_b.decimals)==0||o.positionInfo.poolInfo.is_pause,onClick:o.toClaim},{default:y(()=>[U(a(o.$t("common.claim")),1)]),_:1},8,["disabled","onClick"])]),_:1},8,["title"])}const dn=ho(xe,[["render",rn],["__scopeId","data-v-39d55de9"]]),un=Io({setup(){const o=p(!1),f=p(!1),j=p(!1),J=p(!0),h=vo(),b=_(()=>h),m=ko(),I=p(""),g=p(""),L=p(""),B=p(30),V=p("Estimated APR"),N=p([{time:"24H",num:24},{time:"7D",num:7},{time:"30D",num:30}]),C=p(!0),A=s=>{console.log(s,"====>>>>item",s.num,B.value),B.value=s.num},S=()=>{C.value=!C.value},i=_(()=>m),E=_(()=>{var d,l,T,P;const s=e.value.feeOwedA*((d=i.value.RATES[e.value&&e.value.token_a&&e.value.token_a.address])==null?void 0:d.price),t=e.value.feeOwedB*((l=i.value.RATES[e.value&&e.value.token_b&&e.value.token_b.address])==null?void 0:l.price);return(T=i.value.RATES[e.value&&e.value.token_a&&e.value.token_a.address])!=null&&T.price&&((P=i.value.RATES[e.value&&e.value.token_b&&e.value.token_b.address])!=null&&P.price)?s+t:" --"}),e=p({}),v=ue();function D(){v.push(`/remove-liquidity?collect=${e.value.collectionName}&&token=${e.value.tokenName}&&address=${e.value.pool}&pos=${e.value.pos_object_id}`)}function q(){v.push(`/increase-liquidity?collect=${e.value.collectionName}&&token=${e.value.tokenName}&&address=${e.value.pool}&pos=${e.value.pos_object_id}`)}const so=()=>{io(),j.value=!0,setTimeout(()=>{j.value=!1},1e3)},R=_(()=>b.value.chainName?ae(b.value.chainName):{}),io=async()=>{i.value.setCurrentPositionLoading(!0);const s=v.currentRoute.value.query.token||"",t=v.currentRoute.value.query.collect||"",d=v.currentRoute.value.query.address||"",l=v.currentRoute.value.query.pos||"";g.value=d,b.value.chainName==="Aptos"?s&&t&&d&&(I.value=t,L.value=s,i.value.setCurrentPositionInfo(g.value,I.value,L.value,b.value.chainName)):s&&d&&l&&(I.value=t,L.value=s,i.value.setCurrentPositionInfo(d,I.value,L.value,b.value.chainName,l))},_o=_(()=>{var t,d,l;const s=((l=(d=(t=v==null?void 0:v.currentRoute)==null?void 0:t.value)==null?void 0:d.query)==null?void 0:l.address)||"";return s&&i.value.addressLpTokens&&!z(i.value.addressLpTokens)&&i.value.addressLpTokens[s]?i.value.addressLpTokens[s]:null});eo(()=>_o.value,(s,t)=>{console.log(s,"===>newVal"),s&&!z(s)&&s.current_sqrt_price!==(t==null?void 0:t.current_sqrt_price)&&io()},{immediate:!0});const yo=p(""),$o=p(""),Co=p(""),Wo=(s,t)=>s&&t?K(be.plus(co(s),co(t)),2)+"%":s,To=s=>{let t=0;return s&&s.forEach(d=>{console.log(d,"===>ele"),t+=co(String(d))}),String(K(String(t),2))},Ao=p(""),So=p("");eo(()=>[b.value.newTopPoolsObj,e.value,B],([s,t])=>{if(!z(s)&&!z(t)){const d=t.poolAddress,l=s[d];yo.value=l&&l.apr_7day,So.value=To(l&&l.rewarder_apr),Ao.value=Wo(l&&l.apr_7day,l&&To(l.rewarder_apr)),$o.value=l&&K(l.tvl_in_usd,2),Co.value=l&&K(l.vol_in_usd_24h,2)}},{immediate:!0,deep:!0});const Ho=ie(),Y=_(()=>Ho),{t:lo}=bo(),{$notify:Ro}=re(),Mo=async()=>{o.value=!0,f.value=!1,h.setTransactionDesc(lo("newAdd.claimWaitingText",{from:u(e.value.feeOwedA,e.value.token_a.decimals)==0?"":`${$(e.value.feeOwedA,e.value.token_a.decimals)} ${e.value.token_a.symbol}`,and:u(e.value.feeOwedA,e.value.token_a.decimals)==0||u(e.value.feeOwedB,e.value.token_b.decimals)==0?"":"and",to:u(e.value.feeOwedB,e.value.token_b.decimals)==0?"":`${$(e.value.feeOwedB,e.value.token_b.decimals)} ${e.value.token_b.symbol}`})),h.setIsShowWaiting(!0);let s;const t={pool:e.value.poolInfo,position:e.value};try{const d=await R.value.getCollectFeeTransactionPayload(t);if(b.value.chainName==="Aptos")s=await Y.value.currentWallet.signAndSubmitTransaction(d);else{const l=await Y.value.currentWallet.signAndExecuteTransactionBlock(d);s=R.value.handleTx(l)}if(s){h.setTransactionTxid(s.hash),h.setIsShowWaiting(!1),h.setIsShowSuccess(!0);const l={title:"Claim",desc:"",hash:s.hash,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${e.value.token_a.symbol}`,numa:u(e.value.feeOwedA,e.value.token_a.decimals)==0?"":`+ ${$(e.value.feeOwedA,e.value.token_a.decimals)}`,logoa:u(e.value.feeOwedA,e.value.token_a.decimals)==0?"":i.value.tokensObj&&e.value&&e.value.token_a.address&&i.value.tokensObj[e.value.token_a.address]&&i.value.tokensObj[e.value.token_a.address].logoURI,tokenb:`${e.value.token_b.symbol}`,numb:u(e.value.feeOwedB,e.value.token_b.decimals)==0?"":`+ ${$(e.value.feeOwedB,e.value.token_b.decimals)}`,logob:u(e.value.feeOwedB,e.value.token_b.decimals)==0?"":i.value.tokensObj&&e.value&&e.value.token_b.address&&i.value.tokensObj[e.value.token_b.address]&&i.value.tokensObj[e.value.token_b.address].logoURI},text:`Claim ${u(e.value.feeOwedA,e.value.token_a.decimals)==0?"":`${$(e.value.feeOwedA,e.value.token_a.decimals)} ${e.value.token_a.symbol}`}  
              ${u(e.value.feeOwedA,e.value.token_a.decimals)==0||u(e.value.feeOwedB,e.value.token_b.decimals)==0?"":"and"} ${u(e.value.feeOwedB,e.value.token_b.decimals)==0?"":`${$(e.value.feeOwedB,e.value.token_b.decimals)} ${e.value.token_b.symbol}`}

            `};b.value.chainName!=="Aptos"&&(l.res=s.res),R.value.showTransitionPending(l);const T=await R.value.watchTransaction(l);console.log("0310##toClaim###transitionStatus####",T),T&&setTimeout(()=>{io()},1e3)}else h.setIsShowWaiting(!1),h.setIsShowRejected(!0),Ro.error({icon:M("svg",{class:{icon:!0},"aria-hidden":!0},[M("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),duration:4.5,message:M("div",{class:"notification-title"},[M("span",{innerHTML:Bo.global.t("newAdd.claimFailed")},null)]),description:lo("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"});o.value=!1,console.log("claim####test###",s)}catch(d){console.log("claim###error####",d),o.value=!1,h.setIsShowWaiting(!1),h.setIsShowRejected(!0),Ro.error({icon:M("svg",{class:{icon:!0},"aria-hidden":!0},[M("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:M("div",{class:"notification-title"},[M("span",{innerHTML:Bo.global.t("newAdd.claimFailed")},null)]),duration:4.5,description:lo("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"})}},ro=p(""),uo=p(""),zo=()=>{ro.value=e.value.token_b,uo.value=e.value.token_a},Go=async(s=null)=>{const t=s||e.value,d=i.value.addressLpTokens[v.currentRoute.value.query.address];console.log("0309###getRewarder###pools.value.addressLpTokens###",i.value.addressLpTokens),console.log("0309###getRewarder###pool###",d);const l=await R.value.getTickDataByIndex(d.ticks_handle,Number(t.tick_lower_index)),T=await R.value.getTickDataByIndex(d.ticks_handle,Number(t.tick_upper_index));let P={};Oo.value==="Aptos"?P=await R.value.getPosRewardersAmount({poolAddress:v.currentRoute.value.query.address,positionName:v.currentRoute.value.query.token,tickLowerData:l,tickUpperData:T}):P=await R.value.getPosRewardersAmount({poolAddress:v.currentRoute.value.query.address,pos:v.currentRoute.value.query.pos,positionHandle:d.positions_handle});const X=[];let F=0;P.forEach((O,x)=>{if(t.poolInfo[`rewarder_display${x+1}`]){const oo=i.value.newTokenObj[O.coin_address].decimals,xo=i.value.newTokenObj[O.coin_address];console.log(O.amount_owed.toString(),"===>element.amount_owed.toString()");const oe=Number(O.amount_owed.toString())>99999999999999?0:Number(O.amount_owed.toString()),jo=Number(oe/Math.pow(10,oo)),ee=i.value.RATES[O.coin_address].price,Lo=jo*ee;F+=Lo,X.push({...O,...xo,amount:K(jo,oo),amountUSD:K(Lo,2)})}}),ao.value=X,console.log(X,"====>result722"),mo.value=F,No.value=Number(K(F,2))};eo(()=>i.value.currentPositionInfo,s=>{s&&(e.value=s,ro.value=s==null?void 0:s.token_a,uo.value=s==null?void 0:s.token_b,console.log(s,"positionInfo.valuepositionInfo.value"))},{immediate:!0});const Jo=_(()=>i.value.tokensObj&&e&&e.value.token_a&&e.value.token_a.address&&i.value.tokensObj[e.value.token_a.address]&&i.value.tokensObj[e.value.token_a.address].logoURI),Xo=_(()=>i.value.tokensObj&&e&&e.value.token_b&&e.value.token_b.address&&i.value.tokensObj[e.value.token_b.address]&&i.value.tokensObj[e.value.token_b.address].logoURI),Oo=_(()=>b.value.chainName),Ko=_(()=>no[Oo.value]),mo=p(0),ao=p([]),No=p(0);de(()=>{mo.value=0,ao.value=[],No.value=0});const{setIsShowSuccess:Qo,setIsShowRejected:Po,setIsShowWaiting:po,setTransactionDesc:cs,setTransactionTxid:Yo}=h,to=p(!1),Zo=async()=>{console.log("0310###toClaimRewards##start"),to.value=!0;const s=ao.value;let t={coinTypeA:e.value.poolInfo.coinTypeA,coinTypeB:e.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:e.value.poolAddress,pos_index:e.value.index,rewarder_nums:s.length};t.coinTypeC=s[0]?s[0].coin_address:"",t.coinTypeD=s[1]?s[1].coin_address:"",t.coinTypeE=s[2]?s[2].coin_address:"",console.log(t,"===>collectRewarderParams");try{const d=await R.value.getCollectRewarderTransactionPayload(t);let l;if(b.value.chainName==="Aptos")l=await Y.value.currentWallet.signAndSubmitTransaction(d);else{const T=await Y.value.currentWallet.signAndExecuteTransactionBlock(d);l=R.value.handleTx(T)}if(console.log("0310###toClaimRewards##tx###",l),l&&l.hash){Yo(l.hash),po(!1),Qo(!0);const T=s[0].amount+s[0].symbol,P=t.coinTypeD?" and "+s[1].amount+s[1].symbol:"",X=t.coinTypeE?" and "+s[2].amount+s[2].symbol:"",F={title:"Claim",desc:"",hash:l.hash,tit:"Bonus Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:s[0].symbol,numa:`+ ${Number(s[0].amount)}`,logoa:i.value.tokensObj&&s[0]&&s[0].address&&i.value.tokensObj[s[0].address]&&i.value.tokensObj[s[0].address].logoURI,tokenb:t.coinTypeD?s[1].symbol:"",numb:t.coinTypeD?`+ ${Number(s[1].amount)}`:"",logob:t.coinTypeD?i.value.tokensObj&&s[1]&&s[1].address&&i.value.tokensObj[s[1].address]&&i.value.tokensObj[s[1].address].logoURI:"",tokenc:t.coinTypeE?s[2].symbol:"",numc:t.coinTypeE?`+ ${Number(s[2].amount)}`:"",logoc:t.coinTypeE?i.value.tokensObj&&s[2]&&s[2].address&&i.value.tokensObj[s[2].address]&&i.value.tokensObj[s[2].address].logoURI:""},text:T+P+X};b.value.chainName!=="Aptos"&&(F.res=l.res),R.value.showTransitionPending(F);const O=await R.value.watchTransaction(F);console.log("0310###toClaimRewards###transitionStatus###",O),O&&setTimeout(()=>{io(),R.value.getAccount(Y.value.address)},3e3)}else console.log("0310###toClaimRewards###else###"),po(!1),Po(!0);to.value=!1}catch(d){console.log("0310###Claim Error###",d),to.value=!1,po(!1),Po(!0)}};console.log(e,"===>positionInfo");const Uo=p([]);eo(()=>[e.value,i.value.addressLpTokens,i.value.newTokenObj,b.value.newTopPoolsObj],([s,t,d,l])=>{if(!z(s)&&!z(t)&&!z(d)){const T=s.address,P=t[T];let X=P.rewarder_infos||[];const F=l[T],O=[];X.forEach((x,oo)=>{P[`rewarder_display${oo+1}`]&&O.push({...x,symbol:d[x.coinAddress].symbol,rewarderApr:F.rewarder_apr[oo],logoUrl:d[x.coinAddress].logoURI})}),Uo.value=O,Go(s)}},{immediate:!0,deep:!0});const Vo=p();return eo(()=>i.value.RATES,s=>{s&&(Vo.value=s)},{immediate:!0}),{rewarderArr:Uo,feeOwed:E,config:Ko,showNum:$,index:b,fromCoinUrl:Jo,toCoinUrl:Xo,toggle:zo,fromCoin:ro,toCoin:uo,apr:yo,liquidityTvl:$o,vol24:Co,addCommom:u,decimalFormat:G,wallet:Y,isLoading:o,toClaim:Mo,pools:i,positionInfo:e,importIcon:H,router:v,toRemove:D,toIncrease:q,isShowClaim:f,direct:J,refresh:j,clickRefresh:so,pendingRewarderArr:ao,pendingRewarder:mo,toClaimRewards:Zo,rewarderLoading:to,aprRewardsParameter:B,aprRewardsDateList:N,aprTab:A,reviseValue:S,label:C,aprTitle:V,aprTotal:Ao,rewardAprList:So,currentPoolInfo:_o}}});const Z=o=>(go("data-v-49ec1e2f"),o=o(),wo(),o),mn={key:0,class:"position-detail-container"},pn={class:"position-detail-header"},cn={class:"back-and-refresh"},fn=Z(()=>n("use",{"xlink:href":"#icon-icon-refresh"},null,-1)),vn=[fn],kn={class:"action-position"},In={class:"coin-pair"},bn=Z(()=>n("use",{"xlink:href":"#icon-icon-copy"},null,-1)),hn=[bn],gn=["href"],wn=Z(()=>n("svg",{class:"icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-icon-jump"})],-1)),_n=[wn],yn=["href"],$n=Z(()=>n("svg",{class:"icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-icon-jump"})],-1)),Cn=[$n],Tn={class:"acton-btn-box"},An=Z(()=>n("svg",{"aria-hidden":"true",class:"action-icon"},[n("use",{"xlink:href":"#icon-icon-Reduction"})],-1)),Sn=Z(()=>n("svg",{"aria-hidden":"true",class:"action-icon"},[n("use",{"xlink:href":"#icon-icon-add"})],-1)),Rn={class:"position-content"},On={class:"pedding-fee"},Nn={class:"pedding-fee"},Pn={class:"top"},Un={class:"left"},jn={class:"bottom"},Ln=["src"],Bn=["src"],En={key:0,class:"pedding-fee"},Dn={class:"top"},qn={class:"left"},Fn={class:"bottom"},Wn=["src"],Hn={key:1,class:"poolInfo"},Mn={class:"pool-info-title"},zn={class:"currentPrice"},Gn={key:0,class:"coin"},Jn={key:1,class:"coin"},Xn={class:"toggle"},Kn=["src"],Qn=["src"],Yn={key:0},Zn={class:"info-block-container"},Vn={class:"info-block"},xn={class:"leabl"},os={class:"text"},es={class:"apr-hover-content"},ns={class:"info-block"},ss={class:"leabl"},is={class:"text"},as={class:"info-block"},ts={class:"leabl"},ls={class:"text"},rs={class:"info-block"},ds={class:"leabl"},us={class:"text"},ms={class:"loading-global"};function ps(o,f,j,J,h,b){var A,S;const m=ne,I=Do,g=Eo,L=Ve,B=ke,V=Ie,N=dn,C=ce;return o.positionInfo?(c(),k("div",mn,[n("div",pn,[n("div",cn,[w(m),(c(),k("svg",{"aria-hidden":"true",class:Q(o.refresh?"refresh refresh-icon ":"refresh-icon"),onClick:f[0]||(f[0]=(...i)=>o.clickRefresh&&o.clickRefresh(...i))},vn,2))]),n("div",kn,[w(g,{loading:o.pools.currentPositionLoading,active:"",paragraph:!1},{default:y(()=>{var i,E,e,v,D,q;return[n("div",In,[U(a(o.positionInfo.tokenName)+" ",1),(c(),k("svg",{class:"icon","aria-hidden":"true",onClick:f[1]||(f[1]=so=>o.index.copy(o.positionInfo.nftHash))},hn)),o.index&&o.index.chainName==="Aptos"?(c(),k("a",{key:0,href:`${("config"in o?o.config:r(no)).explorerUrl}/token/${o.positionInfo.nftHash}/0?network=${("config"in o?o.config:r(no)).network}`,target:"_blank"},_n,8,gn)):(c(),k("a",{key:1,href:`${("config"in o?o.config:r(no)).explorerUrl}/object/${o.positionInfo.nftHash}?network=${("config"in o?o.config:r(no)).network}`,target:"_blank"},Cn,8,yn))]),n("div",Tn,[w(I,{class:Q(["remove-liquidity action-btn",(E=(i=o.positionInfo)==null?void 0:i.poolInfo)!=null&&E.is_pause?"text-default":""]),disabled:(v=(e=o.positionInfo)==null?void 0:e.poolInfo)==null?void 0:v.is_pause,onClick:o.toRemove},{default:y(()=>[An,U(" "+a(o.$t("button.remove")),1)]),_:1},8,["class","disabled","onClick"]),w(I,{class:"increase-liquidity action-btn",disabled:(q=(D=o.positionInfo)==null?void 0:D.poolInfo)==null?void 0:q.is_pause,onClick:o.toIncrease},{default:y(()=>[Sn,U(" "+a(o.$t("button.increase")),1)]),_:1},8,["disabled","onClick"])])]}),_:1},8,["loading"])])]),n("div",Rn,[w(L,{"position-info":o.positionInfo},null,8,["position-info"])]),n("div",On,[(c(),fo(B,{key:0,"apr-title":o.aprTitle,"apr-rewards-date-list":o.aprRewardsDateList,"apr-rewards-parameter":o.aprRewardsParameter,"name-tab":"position","from-coin":o.fromCoin,"to-coin":o.toCoin,"pool-info":o.positionInfo.poolInfo,"min-price":o.positionInfo.minPrice,"max-price":o.positionInfo.maxPrice&&String(o.positionInfo.maxPrice).indexOf("+")>-1?"∞":o.positionInfo.maxPrice,onAprTab:o.aprTab},null,8,["apr-title","apr-rewards-date-list","apr-rewards-parameter","from-coin","to-coin","pool-info","min-price","max-price","onAprTab"]))]),n("div",Nn,[n("div",Pn,[n("div",Un,[n("span",null,a(o.$t("newAdd.pendingFees")),1),n("p",null," $"+a(o.pools.currentPositionLoading||o.feeOwed=="--"?"--":Number(o.feeOwed)==0?0:Number(o.feeOwed)<.01?"<0.01":("addCommom"in o?o.addCommom:r(u))(o.feeOwed,2)),1)]),w(I,{class:"increase-liquidity action-btn",disabled:o.isLoading||!o.wallet.connected||!(Number(o.positionInfo&&o.positionInfo.feeOwedA)||Number(o.positionInfo&&o.positionInfo.feeOwedB))||o.positionInfo.poolInfo.is_pause,onClick:f[2]||(f[2]=i=>o.isShowClaim=!0)},{default:y(()=>[U(a(o.$t("common.claim")),1)]),_:1},8,["disabled"])]),w(g,{loading:o.pools.currentPositionLoading,active:"",paragraph:!1},{default:y(()=>[n("div",jn,[n("div",null,[n("img",{src:o.fromCoinUrl},null,8,Ln),n("p",null,a(("showNum"in o?o.showNum:r($))(o.positionInfo.feeOwedA,o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals)),1),n("span",null,a(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol),1)]),n("div",null,[n("img",{src:o.toCoinUrl},null,8,Bn),n("p",null,a(("showNum"in o?o.showNum:r($))(o.positionInfo.feeOwedB,o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals)),1),n("span",null,a(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol),1)])])]),_:1},8,["loading"])]),o.positionInfo&&o.positionInfo.poolInfo&&o.positionInfo.poolInfo.rewarder_infos&&o.positionInfo.poolInfo.rewarder_infos.length>0&&o.positionInfo.poolInfo.is_display_rewarder&&o.pendingRewarderArr&&o.pendingRewarderArr.length>0?(c(),k("div",En,[n("div",Dn,[n("div",qn,[n("span",null,a(o.$t("newAdd.pendingRewards")),1),n("p",null," $"+a(o.pendingRewarder=="--"?"--":Number(o.pendingRewarder)==0?0:Number(o.pendingRewarder)<.01?"<0.01":("addCommom"in o?o.addCommom:r(u))(o.pendingRewarder,2)),1)]),w(I,{class:"increase-liquidity action-btn",disabled:o.rewarderLoading||!o.wallet.connected||o.pendingRewarder<=0||((S=(A=o.positionInfo)==null?void 0:A.poolInfo)==null?void 0:S.is_pause),loading:o.rewarderLoading,onClick:o.toClaimRewards},{default:y(()=>[U(a(o.$t("common.claim")),1)]),_:1},8,["disabled","loading","onClick"])]),w(g,{loading:o.pools.currentPositionLoading,active:"",paragraph:!1},{default:y(()=>[n("div",Fn,[(c(!0),k(fe,null,ve(o.pendingRewarderArr,i=>(c(),k("div",{key:i,class:Q(Number(i==null?void 0:i.amount)==0?"reward-none":"")},[n("img",{src:i.logoURI,alt:""},null,8,Wn),n("p",null,a(i.amount),1),n("span",null,a(i.symbol),1)],2))),128))])]),_:1},8,["loading"])])):W("",!0),o.positionInfo&&o.positionInfo.poolInfo?(c(),k("div",Hn,[n("div",Mn,a(o.$t("newAdd.poolInfo")),1),n("div",zn,[w(g,{loading:o.pools.currentPositionLoading,active:"",paragraph:!1},{default:y(()=>{var i,E,e,v,D,q;return[o.direct?(c(),k("div",Gn,[n("span",null,a(o.$t("common.currentPrice")),1),U(" "+a(("addCommom"in o?o.addCommom:r(u))(("decimalFormat"in o?o.decimalFormat:r(G))(o.positionInfo.currentPrice,6),6))+" "+a((i=o.toCoin)==null?void 0:i.symbol)+" per "+a((E=o.fromCoin)==null?void 0:E.symbol),1)])):(c(),k("div",Jn,[n("span",null,a(o.$t("common.currentPrice")),1),U(" "+a(("addCommom"in o?o.addCommom:r(u))(("decimalFormat"in o?o.decimalFormat:r(G))(1/o.positionInfo.currentPrice,6),6))+" "+a((e=o.fromCoin)==null?void 0:e.symbol)+" per "+a((v=o.toCoin)==null?void 0:v.symbol),1)])),n("div",Xn,[n("div",{class:Q(o.direct?"item active-item":"item"),onClick:f[3]||(f[3]=so=>o.direct=!0)},[n("img",{src:o.fromCoinUrl,alt:""},null,8,Kn),U(" "+a(o.positionInfo&&o.positionInfo.token_a&&((D=o.positionInfo.token_a)==null?void 0:D.symbol)),1)],2),n("div",{class:Q(o.direct?"item ":"item active-item"),onClick:f[4]||(f[4]=so=>o.direct=!1)},[n("img",{src:o.toCoinUrl,alt:""},null,8,Qn),U(" "+a(o.positionInfo&&o.positionInfo.token_b&&((q=o.positionInfo.token_b)==null?void 0:q.symbol)),1)],2)])]}),_:1},8,["loading"])]),w(g,{loading:o.pools.currentPositionLoading,active:"",paragraph:!1},{default:y(()=>[o.aprTotal&&o.liquidityTvl&&o.vol24?(c(),k("div",Yn,[n("div",Zn,[n("div",Vn,[n("div",xn,a(o.$t("common.apr")),1),n("div",os,[U(a(o.aprTotal?("addCommom"in o?o.addCommom:r(u))(o.aprTotal.substring(0,o.aprTotal.length-1),2):0)+"% ",1),n("div",es,[w(V,{class:Q(o.isShow?"showHover apr-hover-con":"noHover apr-hover-con"),"l-item":{apr:o.apr,rewarder_apr:o.rewardAprList,aprTotal:o.aprTotal,is_display_rewarder:o.positionInfo.poolInfo.is_display_rewarder},"rewarder-info":o.rewarderArr},null,8,["class","l-item","rewarder-info"])])])]),n("div",ns,[n("div",ss,a(o.$t("common.liquidity")),1),n("div",is,"$"+a(("addCommom"in o?o.addCommom:r(u))(o.liquidityTvl,2)),1)]),n("div",as,[n("div",ts,a(o.$t("common.volume24h")),1),n("div",ls,"$"+a(("addCommom"in o?o.addCommom:r(u))(o.vol24,2)),1)]),n("div",rs,[n("div",ds,a(o.$t("newAdd.tickSpacing")),1),n("div",us,a(o.positionInfo.tickSpacing),1)])])])):W("",!0)]),_:1},8,["loading"])])):W("",!0),o.isShowClaim?(c(),fo(N,{key:2,"is-loading":o.isLoading,"position-info":o.positionInfo,onOnClose:f[5]||(f[5]=i=>o.isShowClaim=!1),onToClaim:o.toClaim},null,8,["is-loading","position-info","onToClaim"])):W("",!0),me(n("div",ms,[w(C)],512),[[pe,o.pools.currentPositionLoading]])])):W("",!0)}const As=ho(un,[["render",ps],["__scopeId","data-v-49ec1e2f"]]);export{As as default};
