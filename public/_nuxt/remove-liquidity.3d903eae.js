import{_ as jo}from"./back.caa019d8.js";import{_ as qo}from"./coin-pair-name.c31d62b3.js";import{_ as Bo}from"./status-block.2197ddaa.js";import{_ as Po,a as Uo}from"./swap-setting.5d1d34c2.js";import{a as Lo,Z as Do,r,e as Eo,i as B,b as Fo,$ as Wo,W as Vo,f2 as Mo,w as Q,fh as Xo,ac as P,Q as b,x as zo,fi as ko,fj as Go,B as ro,L as ho,z as Io,A as Ko,j as Z,k as Qo,o as S,l as U,E as L,m as e,t,q as vo,c as _o,p as eo,G as go,T as yo,C as D,F as Zo,N as Ho,O as Jo,I as Yo,fk as xo,K as oe,s as ee,v as ne,U as se}from"./entry.08441bee.js";import{p as mo}from"./precision.ce0280e5.js";const ae=Lo({setup(){const{t:o,locale:c}=Do();let co=r(!1),z=r(!1);const H=r(!1),po=()=>{x(),H.value=!0,setTimeout(()=>{H.value=!1},1e3)},so=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],G=Eo(),I=B(()=>G),ao=Fo(),E=r(""),F=r(""),W=r(""),J=r(""),Y=r(""),l=r(""),V=r(""),to=r(""),wo=i=>{let d=i.replace(/[^\d.]/g,"");const h=/^\d+(\.\d+)?$/;d.split(".").length>2&&!h.exec(d)&&(d=d.substr(0,d.length-1)),w.value=d},s=B(()=>ao),v=r({}),m=r({}),n=r(s.value.currentPositionInfo||{}),No=Wo(),K=B(()=>No),j=Vo();Mo(()=>{K.value.connected||j.push("/position")});const g=B(()=>I.value.chainName?Ko(I.value.chainName):{}),x=async()=>{s.value.setCurrentPositionLoading(!0);const i=j.currentRoute.value.query.token||"",d=j.currentRoute.value.query.collect||"",h=j.currentRoute.value.query.pos||"";I.value.chainName==="Aptos"?i&&d&&(E.value=d,F.value=j.currentRoute.value.query.address,W.value=i,s.value.setCurrentPositionInfo(F.value,E.value,W.value,I.value.chainName),n.value=s.value.currentPositionInfo):h&&(E.value=d,F.value=j.currentRoute.value.query.address,W.value=i,s.value.setCurrentPositionInfo(F.value,E.value,W.value,I.value.chainName,h),n.value=s.value.currentPositionInfo)};Q(()=>s.value.addressLpTokens,i=>{Z(i)||x()},{immediate:!0}),Q(()=>s.value.currentPositionInfo,i=>{i&&(n.value=s.value.currentPositionInfo,v.value=n.value.token_a,m.value=n.value.token_b,uo({value:w.value/100}),console.log(n.value,"  positionInfo.valuepositionInfo.value"))});const w=r(50),f=r(0),k=r(0),io=r(0),lo=B(()=>G.slippage);Q(w,Xo((i,d)=>{Number(i)>100?w.value=100:i&&n.value&&(w.value=i,uo({value:w.value/100}))},300)),Q(lo,i=>{i&&n.value&&uo({value:w.value/100})});const uo=i=>{var O,R;const d=n.value.token_a.decimals,h=n.value.token_b.decimals,q=n.value.tick_lower_index,T=n.value.tick_upper_index,M=ko.tickIndexToSqrtPriceX64(q),X=ko.tickIndexToSqrtPriceX64(T);io.value=n.value.liquidity*Number(i.value);const A=Go.getCoinAmountFromLiquidity(new ro(io.value),new ro(n.value.current_sqrt_price),M,X,!0),C=Number(A.coinA.toString())/Math.pow(10,d),u=Number(A.coinB.toString())/Math.pow(10,h);console.log(C,u,"amountA121212"),f.value=C,k.value=u;const a=(O=s.value.RATES[n.value.token_a.address])==null?void 0:O.price,$=(R=s.value.RATES[n.value.token_b.address])==null?void 0:R.price;console.log(f.value,a,"fromCoinAmount.value"),J.value=Number(f.value*a)<.01?Number(f.value*a)===0?"0":"<0.01":b(f.value*a,2),Y.value=Number(k.value*$)<.01?Number(k.value*$)===0?"0":"<0.01":b(k.value*$,2);const p=mo.minus(Number(n.value.amountA),Number(f.value))*a;l.value=Number(p)<.01?Number(p)===0?"0":"<0.01":b(p,2);const _=mo.minus(Number(n.value.amountB),Number(k.value))*$;V.value=Number(_)<.01?Number(_)===0?"0":"<0.01":b(_,2);const y=Number(ho(p,2))+Number(ho(_,2));to.value=Number(y)<.01?Number(y)===0?"0":"<0.01":b(y,2)},{setIsShowSuccess:Ao,setIsShowRejected:fo,setIsShowWaiting:oo,setTransactionDesc:$o,setTransactionTxid:bo,setPositiomNum:ln,setTransactionDescText:Ro}=G,So=async()=>{var d,h,q,T,M,X,A,C;z.value=!0,bo(""),$o(o("tips.removeLiquidiyText",{from:b(f.value,v.value.decimals)==0?"":`${P(f.value,v.value.decimals)} ${v.value.symbol}`,and:b(f.value,v.value.decimals)==0||b(k.value,m.value.decimals)==0?"":"and",to:b(k.value,m.value.decimals)==0?"":`${P(k.value,m.value.decimals)} ${m.value.symbol}`})),oo(!0);const i=N.value&&N.value.length>0?o("modal.removeLiquidityText1"):o("modal.removeLiquidityText2");Ro(i);try{let u={};u={pool:{...n.value.poolInfo,coinA:n.value.token_a,coinB:n.value.token_b},coinTypeA:n.value.poolInfo.coinTypeA,coinTypeB:n.value.poolInfo.coinTypeB,position:n.value,delta_liquidity:new ro(Io(io.value,0)),slippage:Number(lo.value),rewards_num:N.value.length};const a=N.value;console.log(N,"===>pendingRewarderArr"),u.coinTypeC=a[0]?a[0].coin_address:"",u.coinTypeD=a[1]?a[1].coin_address:"",u.coinTypeE=a[2]?a[2].coin_address:"",console.log(u,"===>params");const $=await g.value.getRemoveLiquidityTransactionPayload(u);let p;if(I.value.chainName==="Aptos")p=await K.value.currentWallet.signAndSubmitTransaction($);else{const _=await K.value.currentWallet.signAndExecuteTransaction($);p=g.value.handleTx(_)}if(p&&p.hash){bo(p.hash),oo(!1),Ao(!0),console.log("9999###705");const _={title:o("common.removeLiquidity"),desc:"",hash:p.hash,descTransactions:`Remove ${f.value} ${(d=v.value)==null?void 0:d.symbol} and ${k.value} ${(h=m.value)==null?void 0:h.symbol} 
             from the pool`,sender:K.value.address,chainName:I.value.chainName,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${(q=v.value)==null?void 0:q.symbol}`,numa:`+ ${f.value}`,logoa:s.value.tokensObj&&v.value&&v.value.address&&s.value.tokensObj[v.value.address]&&s.value.tokensObj[v.value.address].logoURI,tokenb:`${(T=m.value)==null?void 0:T.symbol}`,numb:`+ ${k.value}`,logob:s.value.tokensObj&&m.value&&m.value.address&&s.value.tokensObj[m.value.address]&&s.value.tokensObj[m.value.address].logoURI},text:`Withdraw ${f.value} ${(M=v.value)==null?void 0:M.symbol} and ${k.value} ${(X=m.value)==null?void 0:X.symbol}`};g.value.showTransitionPending(_);const y=await g.value.watchTransaction(_);if(N.value&&N.value.length>0){const O={title:o("common.removeLiquidity"),desc:"",hash:p.hash,tit:"Bonus Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:a[0].symbol,numa:`+ ${Number(a[0].amount)}`,logoa:s.value.tokensObj&&a[0]&&a[0].address&&s.value.tokensObj[a[0].address]&&s.value.tokensObj[a[0].address].logoURI,tokenb:u.coinTypeD?a[1].symbol:"",numb:u.coinTypeD?`+ ${Number(a[1].amount)}`:"",logob:u.coinTypeD?s.value.tokensObj&&a[1]&&a[1].address&&s.value.tokensObj[a[1].address]&&s.value.tokensObj[a[1].address].logoURI:"",tokenc:u.coinTypeE?a[2].symbol:"",numc:u.coinTypeE?`+ ${Number(a[2].amount)}`:"",logoc:u.coinTypeE?s.value.tokensObj&&a[2]&&a[2].address&&s.value.tokensObj[a[2].address]&&s.value.tokensObj[a[2].address].logoURI:""},text:`Withdraw ${f.value} ${(A=v.value)==null?void 0:A.symbol} and ${k.value} ${(C=m.value)==null?void 0:C.symbol}`},R=await g.value.setTransations(O);console.log("9999transitionStatusFees",y,R)}if(P(n.value.feeOwedA,n.value.token_a.decimals)!==0||P(n.value.feeOwedB,n.value.token_b.decimals)!==0){const O={title:"Claim",desc:"",hash:p.hash,chainName:I.value.chainName,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${n.value.token_a.symbol}`,numa:b(n.value.feeOwedA,n.value.token_a.decimals)==0?"":`+ ${P(n.value.feeOwedA,n.value.token_a.decimals)}`,logoa:b(n.value.feeOwedA,n.value.token_a.decimals)==0?"":s.value.tokensObj&&n.value&&n.value.token_a.address&&s.value.tokensObj[n.value.token_a.address]&&s.value.tokensObj[n.value.token_a.address].logoURI,tokenb:`${n.value.token_b.symbol}`,numb:b(n.value.feeOwedB,n.value.token_b.decimals)==0?"":`+ ${P(n.value.feeOwedB,n.value.token_b.decimals)}`,logob:b(n.value.feeOwedB,n.value.token_b.decimals)==0?"":s.value.tokensObj&&n.value&&n.value.token_b.address&&s.value.tokensObj[n.value.token_b.address]&&s.value.tokensObj[n.value.token_b.address].logoURI}},R=await g.value.setTransations(O);console.log("9999transitionStatusFees",y,R)}y&&(setTimeout(()=>{x()},3e3),setTimeout(()=>{x()},6e3),Number(w.value)==100&&j.push("/position"))}else console.log("9999###899"),oo(!1),fo(!0);z.value=!1}catch(u){console.log("Remove error",u),z.value=!1,oo(!1),fo(!0)}},To=B(()=>s.value.tokensObj&&v.value.address&&s.value.tokensObj[v.value.address]&&s.value.tokensObj[v.value.address].logoURI),Co=B(()=>s.value.tokensObj&&m.value.address&&s.value.tokensObj[m.value.address]&&s.value.tokensObj[m.value.address].logoURI),Oo=r(0),N=r([]);return Q(()=>[n.value,s.value.addressLpTokens,s.value.newTokenObj,s.value.RATES],async([i,d,h,q])=>{if(!Z(i)&&!Z(d)&&!Z(h)&&!Z(q)){const T=d[i.poolAddress];console.log(T,"===>pool");const M=await g.value.getTickDataByIndex(T.ticks_handle,Number(i.tick_lower_index)),X=await g.value.getTickDataByIndex(T.ticks_handle,Number(i.tick_upper_index));let A={};I.value.chainName==="Aptos"?A=await g.value.getPosRewardersAmount({poolAddress:i.poolAddress,positionName:i.tokenName,tickLowerData:M,tickUpperData:X}):A=await g.value.getPosRewardersAmount({poolAddress:i.poolAddress,pos:i.pos_object_id});const C=[];let u=0;A.forEach((a,$)=>{if(n.value.poolInfo[`rewarder_display${$+1}`]){const p=h[a.coin_address].decimals,_=h[a.coin_address];console.log(a.amount_owed.toString(),"===>element.amount_owed.toString()");const y=Number(a.amount_owed.toString())/Math.pow(10,p),O=q[a.coin_address].price,R=y*O;u+=R,C.push({...a,..._,amount:y,amountUSD:R})}}),N.value=C,Oo.value=Number(Io(u,2))}},{immediate:!0}),{removeAmountARates:l,removeAmountBRates:V,removeAmountRates:to,receiveAmountARates:J,receiveAmountBRates:Y,showNum:P,fromCoinUrl:To,toCoinUrl:Co,precision:mo,addCommom:b,loading:z,wallet:K,toRemove:So,fromCoinAmount:f,toCoinAmount:k,pools:s,refresh:H,amountArr:so,sliderVal:w,positionInfo:n,slippage:lo,importIcon:zo,clickRefresh:po,isShowSwapSetting:co,pendingRewarderArr:N,changeValue:wo}}});const no=o=>(ee("data-v-8ec2aa8f"),o=o(),ne(),o),te={class:"remove-liquidity"},ie={class:"remove-liquidity-top"},le={class:"remove-title"},ue={class:"right title-right"},re=no(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1)),de=no(()=>e("use",{"xlink:href":"#icon-icon-refresh"},null,-1)),ve=[de],me={class:"remove-liquidity-center"},ce={class:"top"},pe={class:"left"},fe={class:"right"},be={class:"fee"},ke={class:"bottom"},he={class:"add-amount"},Ie={class:"add-amount-header"},_e={class:"amount-list"},ge=["onClick"],ye={class:"slider-box"},we={class:"receive"},Ne={class:"receiveTit"},Ae={class:"item"},$e={class:"left"},Re=["src"],Se={class:"right"},Te={class:"item"},Ce={class:"left"},Oe=["src"],je={class:"right"},qe={class:"remove-liquidity-bottom-box"},Be={class:"induction remove-liquidity-bottom"},Pe={class:"item"},Ue={class:"induction-text"},Le={class:"induction-value"},De=["src"],Ee=no(()=>e("div",{class:"induction-text"},null,-1)),Fe={class:"induction-value"},We=["src"],Ve={class:"induction-text"},Me={class:"induction-value"},Xe=["src"],ze=no(()=>e("svg",{"aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-Remove"})],-1)),Ge={key:0,class:"receive"},Ke={class:"receiveTit"},Qe={class:"left"},Ze={class:"right"},He={class:"item"},Je={class:"left"},Ye=["src"],xe={class:"right"},on={class:"item"},en={class:"left"},nn=["src"],sn={class:"right"},an={class:"loading-global"};function tn(o,c,co,z,H,po){const so=jo,G=qo,I=Bo,ao=Yo,E=xo,F=oe,W=Uo,J=Po,Y=se;return S(),U("div",te,[L(so),e("div",ie,[e("div",le,t(o.$t("common.removeLiquidity")),1),e("div",ue,[e("div",{class:"slippage-icon",onClick:c[0]||(c[0]=l=>o.isShowSwapSetting=!0)},[re,e("span",null,t(o.slippage)+"%",1)]),(S(),U("svg",{"aria-hidden":"true",class:vo(o.refresh?"refresh refresh-icon ":"refresh-icon"),onClick:c[1]||(c[1]=(...l)=>o.clickRefresh&&o.clickRefresh(...l))},ve,2))])]),e("div",me,[e("div",ce,[e("div",pe,[o.positionInfo?(S(),_o(G,{key:0,"from-coin":o.positionInfo.token_a,"to-coin":o.positionInfo.token_b},null,8,["from-coin","to-coin"])):eo("",!0),e("div",fe,[e("div",be,t(o.positionInfo.fee*100)+"%",1)])]),L(I,{"current-status":o.positionInfo.currentStatus||""},null,8,["current-status"])]),e("div",ke,[e("div",he,[e("div",Ie,[e("span",null,t(o.$t("common.amount")),1),e("div",_e,[(S(!0),U(go,null,yo(o.amountArr,(l,V)=>(S(),U("div",{key:V,class:vo(["amount-item",o.sliderVal==l.value?"amount-item-active":""]),onClick:to=>o.sliderVal=l.value},t(l.name),11,ge))),128))])]),e("div",ye,[L(ao,{value:o.sliderVal,"onUpdate:value":c[2]||(c[2]=l=>o.sliderVal=l),suffix:"%",onChange:c[3]||(c[3]=l=>o.changeValue(l.target.value))},null,8,["value"]),L(E,{value:o.sliderVal,"onUpdate:value":c[4]||(c[4]=l=>o.sliderVal=l)},null,8,["value"])])])])]),e("div",we,[e("div",Ne,t(o.$t("newAdd.receive")),1),e("div",Ae,[e("div",$e,[e("img",{src:o.fromCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,Re),e("span",null,t(o.showNum(o.fromCoinAmount,o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals)),1),D(" "+t(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol)+" "+t(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.labels&&o.positionInfo.token_a.labels[0]?`(${o.positionInfo.token_a.labels[0]})`:""),1)]),e("div",Se,"\u2248 $"+t(o.receiveAmountARates),1)]),e("div",Te,[e("div",Ce,[e("img",{src:o.toCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,Oe),e("span",null,t(o.showNum(o.toCoinAmount,o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals)),1),D(" "+t(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol)+" "+t(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.labels&&o.positionInfo.token_b.labels[0]?`(${o.positionInfo.token_b.labels[0]})`:""),1)]),e("div",je,"\u2248 $"+t(o.receiveAmountBRates),1)])]),e("div",qe,[e("div",Be,[e("div",Pe,[e("div",Ue,t(o.$t("common.fees")),1),e("div",Le,[e("img",{src:o.fromCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,De),D(" "+t(o.showNum(o.positionInfo&&o.positionInfo.feeOwedA,o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals))+" ",1),e("span",null,t(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol),1)])]),e("div",{class:vo(o.pendingRewarderArr.length>0?"item item-boder":"item")},[Ee,e("div",Fe,[e("img",{src:o.toCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,We),D(" "+t(o.showNum(o.positionInfo&&o.positionInfo.feeOwedB,o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals))+" ",1),e("span",null,t(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol),1)])],2),o.positionInfo.is_display_rewarder?(S(!0),U(go,{key:0},yo(o.pendingRewarderArr,(l,V)=>(S(),U("div",{key:l,class:"item"},[e("div",Ve,t(V==0?o.$t("common.rewards"):""),1),e("div",Me,[e("img",{src:l.logoURI},null,8,Xe),D(" "+t(l.amount>1e-6?l.amount:l.amount===0?"0":"<0.000001")+" ",1),e("span",null,t(l.symbol),1)])]))),128)):eo("",!0)])]),L(F,{disabled:o.wallet.connected?Number(o.sliderVal)==0||o.loading:!1,class:"remove-btn big-btn",onClick:c[5]||(c[5]=l=>o.wallet.connected?o.toRemove():o.wallet.setIsShowWalletModal(!0))},{default:Zo(()=>[ze,e("span",null,t(o.wallet.connected?o.$t("button.remove"):o.$t("button.connectWallet")),1)]),_:1},8,["disabled"]),L(W),o.sliderVal<100?(S(),U("div",Ge,[e("div",Ke,[e("div",Qe,t(o.$t("newAdd.remainingPosition")),1),e("div",Ze,"$"+t(o.removeAmountRates),1)]),e("div",He,[e("div",Je,[e("img",{src:o.fromCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,Ye),e("span",null,t(o.showNum(o.precision.minus(Number(o.positionInfo.amountA),Number(o.fromCoinAmount)),o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals)),1),D(" "+t(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol)+" "+t(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.labels&&o.positionInfo.token_a.labels[0]?`(${o.positionInfo.token_a.labels[0]})`:""),1)]),e("div",xe,"\u2248 $"+t(o.removeAmountARates),1)]),e("div",on,[e("div",en,[e("img",{src:o.toCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,nn),e("span",null,t(o.showNum(o.precision.minus(Number(o.positionInfo.amountB),Number(o.toCoinAmount)),o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals)),1),D(" "+t(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol)+" "+t(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.labels&&o.positionInfo.token_b.labels[0]?`(${o.positionInfo.token_b.labels[0]})`:""),1)]),e("div",sn,"\u2248 $"+t(o.removeAmountBRates),1)])])):eo("",!0),o.isShowSwapSetting?(S(),_o(J,{key:1,onOnClose:c[6]||(c[6]=l=>o.isShowSwapSetting=!1)})):eo("",!0),Ho(e("div",an,[L(Y)],512),[[Jo,o.pools.currentPositionLoading]])])}const pn=Qo(ae,[["render",tn],["__scopeId","data-v-8ec2aa8f"]]);export{pn as default};
