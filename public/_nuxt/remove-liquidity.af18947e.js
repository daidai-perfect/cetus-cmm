import{_ as Bo}from"./back.d80111b5.js";import{_ as Po}from"./coin-pair-name.3a4e5c79.js";import{_ as Lo}from"./status-block.25de363e.js";import{_ as Uo,a as jo}from"./swap-setting.fad9a1df.js";import{a as Oo,Z as Do,r as l,e as Eo,i as T,b as Vo,$ as Wo,W as Mo,f2 as Fo,w as G,fh as Xo,ac as uo,Q as _,x as zo,fi as Io,fj as Go,B as ro,L as ho,z as ko,A as Ko,j as K,k as Qo,o as w,l as q,E as B,m as e,t as n,q as vo,c as _o,p as oo,G as go,T as wo,C as P,F as Zo,N as Ho,O as Jo,I as Yo,fk as xo,K as oe,s as ee,v as ne,U as se}from"./entry.80c7fe87.js";import{p as mo}from"./precision.ce0280e5.js";const ie=Oo({setup(){const{t:o,locale:d}=Do();let co=l(!1),M=l(!1);const Q=l(!1),po=()=>{J(),Q.value=!0,setTimeout(()=>{Q.value=!1},1e3)},no=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],F=Eo(),k=T(()=>F),so=Vo(),L=l(""),U=l(""),j=l(""),Z=l(""),H=l(""),a=l(""),O=l(""),io=l(""),yo=s=>{let u=s.replace(/[^\d.]/g,"");const f=/^\d+(\.\d+)?$/;u.split(".").length>2&&!f.exec(u)&&(u=u.substr(0,u.length-1)),g.value=u},i=T(()=>so),v=l({}),m=l({}),t=l(i.value.currentPositionInfo||{}),Ao=Wo(),X=T(()=>Ao),S=Mo();Fo(()=>{X.value.connected||S.push("/position")});const y=T(()=>k.value.chainName?Ko(k.value.chainName):{}),J=async()=>{i.value.setCurrentPositionLoading(!0);const s=S.currentRoute.value.query.token||"",u=S.currentRoute.value.query.collect||"",f=S.currentRoute.value.query.pos||"";k.value.chainName==="Aptos"?s&&u&&(L.value=u,U.value=S.currentRoute.value.query.address,j.value=s,i.value.setCurrentPositionInfo(U.value,L.value,j.value,k.value.chainName),t.value=i.value.currentPositionInfo):f&&(L.value=u,U.value=S.currentRoute.value.query.address,j.value=s,i.value.setCurrentPositionInfo(U.value,L.value,j.value,k.value.chainName,f),t.value=i.value.currentPositionInfo)};G(()=>i.value.addressLpTokens,s=>{K(s)||J()},{immediate:!0}),G(()=>i.value.currentPositionInfo,s=>{s&&(t.value=i.value.currentPositionInfo,v.value=t.value.token_a,m.value=t.value.token_b,lo({value:g.value/100}),console.log(t.value,"  positionInfo.valuepositionInfo.value"))});const g=l(50),p=l(0),b=l(0),to=l(0),ao=T(()=>F.slippage);G(g,Xo((s,u)=>{Number(s)>100?g.value=100:s&&t.value&&(g.value=s,lo({value:g.value/100}))},300)),G(ao,s=>{s&&t.value&&lo({value:g.value/100})});const lo=s=>{var x,z;const u=t.value.token_a.decimals,f=t.value.token_b.decimals,R=t.value.tick_lower_index,N=t.value.tick_upper_index,D=Io.tickIndexToSqrtPriceX64(R),E=Io.tickIndexToSqrtPriceX64(N);to.value=t.value.liquidity*Number(s.value);const c=Go.getCoinAmountFromLiquidity(new ro(to.value),new ro(t.value.current_sqrt_price),D,E,!0),I=Number(c.coinA.toString())/Math.pow(10,u),$=Number(c.coinB.toString())/Math.pow(10,f);console.log(I,$,"amountA121212"),p.value=I,b.value=$;const r=(x=i.value.RATES[t.value.token_a.address])==null?void 0:x.price,h=(z=i.value.RATES[t.value.token_b.address])==null?void 0:z.price;console.log(p.value,r,"fromCoinAmount.value"),Z.value=Number(p.value*r)<.01?Number(p.value*r)===0?"0":"<0.01":_(p.value*r,2),H.value=Number(b.value*h)<.01?Number(b.value*h)===0?"0":"<0.01":_(b.value*h,2);const C=mo.minus(Number(t.value.amountA),Number(p.value))*r;a.value=Number(C)<.01?Number(C)===0?"0":"<0.01":_(C,2);const V=mo.minus(Number(t.value.amountB),Number(b.value))*h;O.value=Number(V)<.01?Number(V)===0?"0":"<0.01":_(V,2);const W=Number(ho(C,2))+Number(ho(V,2));io.value=Number(W)<.01?Number(W)===0?"0":"<0.01":_(W,2)},{setIsShowSuccess:No,setIsShowRejected:fo,setIsShowWaiting:Y,setTransactionDesc:$o,setTransactionTxid:bo,setPositiomNum:ln,setTransactionDescText:So}=F,Ro=async()=>{var u,f,R,N,D,E;M.value=!0,bo(""),$o(o("tips.removeLiquidiyText",{from:_(p.value,v.value.decimals)==0?"":`${uo(p.value,v.value.decimals)} ${v.value.symbol}`,and:_(p.value,v.value.decimals)==0||_(b.value,m.value.decimals)==0?"":"and",to:_(b.value,m.value.decimals)==0?"":`${uo(b.value,m.value.decimals)} ${m.value.symbol}`})),Y(!0);const s=A.value&&A.value.length>0?o("modal.removeLiquidityText1"):o("modal.removeLiquidityText2");So(s);try{let c={};c={pool:{...t.value.poolInfo,coinA:t.value.token_a,coinB:t.value.token_b},coinTypeA:t.value.poolInfo.coinTypeA,coinTypeB:t.value.poolInfo.coinTypeB,position:t.value,delta_liquidity:new ro(ko(to.value,0)),slippage:Number(ao.value),rewards_num:A.value.length};const I=A.value;console.log(A,"===>pendingRewarderArr"),c.coinTypeC=I[0]?I[0].coin_address:"",c.coinTypeD=I[1]?I[1].coin_address:"",c.coinTypeE=I[2]?I[2].coin_address:"",console.log(c,"===>params");const $=await y.value.getRemoveLiquidityTransactionPayload(c);let r;if(k.value.chainName==="Aptos")r=await X.value.currentWallet.signAndSubmitTransaction($);else{const h=await X.value.currentWallet.signAndExecuteTransaction($);r=y.value.handleTx(h)}if(r&&r.hash){bo(r.hash),Y(!1),No(!0);const h={title:o("common.removeLiquidity"),desc:"",hash:r.hash,descTransactions:`Remove ${p.value} ${(u=v.value)==null?void 0:u.symbol} and ${b.value} ${(f=m.value)==null?void 0:f.symbol} 
             from the pool`,sender:X.value.address,chainName:k.value.chainName,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${(R=v.value)==null?void 0:R.symbol}`,numa:`+ ${p.value}`,logoa:i.value.tokensObj&&v.value&&v.value.address&&i.value.tokensObj[v.value.address]&&i.value.tokensObj[v.value.address].logoURI,tokenb:`${(N=m.value)==null?void 0:N.symbol}`,numb:`+ ${b.value}`,logob:i.value.tokensObj&&m.value&&m.value.address&&i.value.tokensObj[m.value.address]&&i.value.tokensObj[m.value.address].logoURI,pendingRewarderArr:A.value},text:`Withdraw ${p.value} ${(D=v.value)==null?void 0:D.symbol} and ${b.value} ${(E=m.value)==null?void 0:E.symbol}`};y.value.showTransitionPending(h),await y.value.watchTransaction(h)&&(setTimeout(()=>{J()},3e3),setTimeout(()=>{J()},6e3),Number(g.value)==100&&S.push("/position"))}else Y(!1),fo(!0);M.value=!1}catch(c){console.log("Remove error",c),M.value=!1,Y(!1),fo(!0)}},Co=T(()=>i.value.tokensObj&&v.value.address&&i.value.tokensObj[v.value.address]&&i.value.tokensObj[v.value.address].logoURI),To=T(()=>i.value.tokensObj&&m.value.address&&i.value.tokensObj[m.value.address]&&i.value.tokensObj[m.value.address].logoURI),qo=l(0),A=l([]);return G(()=>[t.value,i.value.addressLpTokens,i.value.newTokenObj,i.value.RATES],async([s,u,f,R])=>{if(!K(s)&&!K(u)&&!K(f)&&!K(R)){const N=u[s.poolAddress];console.log(N,"===>pool");const D=await y.value.getTickDataByIndex(N.ticks_handle,Number(s.tick_lower_index)),E=await y.value.getTickDataByIndex(N.ticks_handle,Number(s.tick_upper_index));let c={};k.value.chainName==="Aptos"?c=await y.value.getPosRewardersAmount({poolAddress:s.poolAddress,positionName:s.tokenName,tickLowerData:D,tickUpperData:E}):c=await y.value.getPosRewardersAmount({poolAddress:s.poolAddress,pos:s.pos_object_id});const I=[];let $=0;c.forEach((r,h)=>{if(t.value.poolInfo[`rewarder_display${h+1}`]){const C=f[r.coin_address].decimals,V=f[r.coin_address];console.log(r.amount_owed.toString(),"===>element.amount_owed.toString()");const W=Number(r.amount_owed.toString())/Math.pow(10,C),x=R[r.coin_address].price,z=W*x;$+=z,I.push({...r,...V,amount:W,amountUSD:z})}}),A.value=I,qo.value=Number(ko($,2))}},{immediate:!0}),{removeAmountARates:a,removeAmountBRates:O,removeAmountRates:io,receiveAmountARates:Z,receiveAmountBRates:H,showNum:uo,fromCoinUrl:Co,toCoinUrl:To,precision:mo,addCommom:_,loading:M,wallet:X,toRemove:Ro,fromCoinAmount:p,toCoinAmount:b,pools:i,refresh:Q,amountArr:no,sliderVal:g,positionInfo:t,slippage:ao,importIcon:zo,clickRefresh:po,isShowSwapSetting:co,pendingRewarderArr:A,changeValue:yo}}});const eo=o=>(ee("data-v-ab91508a"),o=o(),ne(),o),te={class:"remove-liquidity"},ae={class:"remove-liquidity-top"},le={class:"remove-title"},ue={class:"right title-right"},re=eo(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1)),de=eo(()=>e("use",{"xlink:href":"#icon-icon-refresh"},null,-1)),ve=[de],me={class:"remove-liquidity-center"},ce={class:"top"},pe={class:"left"},fe={class:"right"},be={class:"fee"},Ie={class:"bottom"},he={class:"add-amount"},ke={class:"add-amount-header"},_e={class:"amount-list"},ge=["onClick"],we={class:"slider-box"},ye={class:"receive"},Ae={class:"receiveTit"},Ne={class:"item"},$e={class:"left"},Se=["src"],Re={class:"right"},Ce={class:"item"},Te={class:"left"},qe=["src"],Be={class:"right"},Pe={class:"remove-liquidity-bottom-box"},Le={class:"induction remove-liquidity-bottom"},Ue={class:"item"},je={class:"induction-text"},Oe={class:"induction-value"},De=["src"],Ee=eo(()=>e("div",{class:"induction-text"},null,-1)),Ve={class:"induction-value"},We=["src"],Me={class:"induction-text"},Fe={class:"induction-value"},Xe=["src"],ze=eo(()=>e("svg",{"aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-Remove"})],-1)),Ge={key:0,class:"receive"},Ke={class:"receiveTit"},Qe={class:"left"},Ze={class:"right"},He={class:"item"},Je={class:"left"},Ye=["src"],xe={class:"right"},on={class:"item"},en={class:"left"},nn=["src"],sn={class:"right"},tn={class:"loading-global"};function an(o,d,co,M,Q,po){const no=Bo,F=Po,k=Lo,so=Yo,L=xo,U=oe,j=jo,Z=Uo,H=se;return w(),q("div",te,[B(no),e("div",ae,[e("div",le,n(o.$t("common.removeLiquidity")),1),e("div",ue,[e("div",{class:"slippage-icon",onClick:d[0]||(d[0]=a=>o.isShowSwapSetting=!0)},[re,e("span",null,n(o.slippage)+"%",1)]),(w(),q("svg",{"aria-hidden":"true",class:vo(o.refresh?"refresh refresh-icon ":"refresh-icon"),onClick:d[1]||(d[1]=(...a)=>o.clickRefresh&&o.clickRefresh(...a))},ve,2))])]),e("div",me,[e("div",ce,[e("div",pe,[o.positionInfo?(w(),_o(F,{key:0,"from-coin":o.positionInfo.token_a,"to-coin":o.positionInfo.token_b},null,8,["from-coin","to-coin"])):oo("",!0),e("div",fe,[e("div",be,n(o.positionInfo.fee*100)+"%",1)])]),B(k,{"current-status":o.positionInfo.currentStatus||""},null,8,["current-status"])]),e("div",Ie,[e("div",he,[e("div",ke,[e("span",null,n(o.$t("common.amount")),1),e("div",_e,[(w(!0),q(go,null,wo(o.amountArr,(a,O)=>(w(),q("div",{key:O,class:vo(["amount-item",o.sliderVal==a.value?"amount-item-active":""]),onClick:io=>o.sliderVal=a.value},n(a.name),11,ge))),128))])]),e("div",we,[B(so,{value:o.sliderVal,"onUpdate:value":d[2]||(d[2]=a=>o.sliderVal=a),suffix:"%",onChange:d[3]||(d[3]=a=>o.changeValue(a.target.value))},null,8,["value"]),B(L,{value:o.sliderVal,"onUpdate:value":d[4]||(d[4]=a=>o.sliderVal=a)},null,8,["value"])])])])]),e("div",ye,[e("div",Ae,n(o.$t("newAdd.receive")),1),e("div",Ne,[e("div",$e,[e("img",{src:o.fromCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,Se),e("span",null,n(o.showNum(o.fromCoinAmount,o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals)),1),P(" "+n(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol)+" "+n(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.labels&&o.positionInfo.token_a.labels[0]?`(${o.positionInfo.token_a.labels[0]})`:""),1)]),e("div",Re,"\u2248 $"+n(o.receiveAmountARates),1)]),e("div",Ce,[e("div",Te,[e("img",{src:o.toCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,qe),e("span",null,n(o.showNum(o.toCoinAmount,o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals)),1),P(" "+n(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol)+" "+n(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.labels&&o.positionInfo.token_b.labels[0]?`(${o.positionInfo.token_b.labels[0]})`:""),1)]),e("div",Be,"\u2248 $"+n(o.receiveAmountBRates),1)])]),e("div",Pe,[e("div",Le,[e("div",Ue,[e("div",je,n(o.$t("common.fees")),1),e("div",Oe,[e("img",{src:o.fromCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,De),P(" "+n(o.showNum(o.positionInfo&&o.positionInfo.feeOwedA,o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals))+" ",1),e("span",null,n(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol),1)])]),e("div",{class:vo(o.pendingRewarderArr.length>0?"item item-boder":"item")},[Ee,e("div",Ve,[e("img",{src:o.toCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,We),P(" "+n(o.showNum(o.positionInfo&&o.positionInfo.feeOwedB,o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals))+" ",1),e("span",null,n(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol),1)])],2),o.positionInfo.is_display_rewarder?(w(!0),q(go,{key:0},wo(o.pendingRewarderArr,(a,O)=>(w(),q("div",{key:a,class:"item"},[e("div",Me,n(O==0?o.$t("common.rewards"):""),1),e("div",Fe,[e("img",{src:a.logoURI},null,8,Xe),P(" "+n(a.amount>1e-6?a.amount:a.amount===0?"0":"<0.000001")+" ",1),e("span",null,n(a.symbol),1)])]))),128)):oo("",!0)])]),B(U,{disabled:o.wallet.connected?Number(o.sliderVal)==0||o.loading:!1,class:"remove-btn big-btn",onClick:d[5]||(d[5]=a=>o.wallet.connected?o.toRemove():o.wallet.setIsShowWalletModal(!0))},{default:Zo(()=>[ze,e("span",null,n(o.wallet.connected?o.$t("button.remove"):o.$t("button.connectWallet")),1)]),_:1},8,["disabled"]),B(j),o.sliderVal<100?(w(),q("div",Ge,[e("div",Ke,[e("div",Qe,n(o.$t("newAdd.remainingPosition")),1),e("div",Ze,"$"+n(o.removeAmountRates),1)]),e("div",He,[e("div",Je,[e("img",{src:o.fromCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,Ye),e("span",null,n(o.showNum(o.precision.minus(Number(o.positionInfo.amountA),Number(o.fromCoinAmount)),o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals)),1),P(" "+n(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol)+" "+n(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.labels&&o.positionInfo.token_a.labels[0]?`(${o.positionInfo.token_a.labels[0]})`:""),1)]),e("div",xe,"\u2248 $"+n(o.removeAmountARates),1)]),e("div",on,[e("div",en,[e("img",{src:o.toCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,nn),e("span",null,n(o.showNum(o.precision.minus(Number(o.positionInfo.amountB),Number(o.toCoinAmount)),o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals)),1),P(" "+n(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol)+" "+n(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.labels&&o.positionInfo.token_b.labels[0]?`(${o.positionInfo.token_b.labels[0]})`:""),1)]),e("div",sn,"\u2248 $"+n(o.removeAmountBRates),1)])])):oo("",!0),o.isShowSwapSetting?(w(),_o(Z,{key:1,onOnClose:d[6]||(d[6]=a=>o.isShowSwapSetting=!1)})):oo("",!0),Ho(e("div",tn,[B(H)],512),[[Jo,o.pools.currentPositionLoading]])])}const pn=Qo(ie,[["render",an],["__scopeId","data-v-ab91508a"]]);export{pn as default};
