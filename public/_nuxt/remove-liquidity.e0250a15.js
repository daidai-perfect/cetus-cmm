import{_ as Po}from"./back.b5851195.js";import{_ as Uo}from"./coin-pair-name.f6715bc9.js";import{_ as Lo}from"./status-block.5ad685de.js";import{a as Do,_ as Eo}from"./network-tips.1594145c.js";import{i as F}from"./import-icon.de3e6c66.js";import{a as Fo,u as Vo,i as Wo,k as I,h as f,b as Mo,c as Y,T as go,C as Xo,d as po,g as _o,f as wo}from"./pool.0a9aff1a.js";import{p as x}from"./precision.a7a6c57b.js";import{a as zo,J as Go,r,f as U,K as Ho,w as Z,a2 as Jo,G as Ko,h as Qo,o as C,i as L,v as D,j as e,t,l as fo,c as yo,k as to,F as No,D as Ao,u as b,s as E,x as Yo,z as Zo,A as xo,I as oe,a3 as ee,B as ne,E as se,p as ie,m as te}from"./entry.cb6f389e.js";/* empty css              *//* empty css              *//* empty css              */const ae=zo({setup(){const{t:o,locale:v}=Go();let bo=r(!1),J=r(!1);const oo=r(!1),ko=()=>{so(),oo.value=!0,setTimeout(()=>{oo.value=!1},1e3)},lo=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],K=Fo(),g=U(()=>K),uo=Vo(),V=r(""),W=r(""),M=r(""),eo=r(""),no=r(""),u=r(""),X=r(""),ro=r(""),$o=l=>{let d=l.replace(/[^\d.]/g,"");const h=/^\d+(\.\d+)?$/;d.split(".").length>2&&!h.exec(d)&&(d=d.substr(0,d.length-1)),N.value=d},s=U(()=>uo),c=r({}),p=r({}),n=r(s.value.currentPositionInfo||{}),Ro=Wo(),Q=U(()=>Ro),q=Ko();Ho(()=>{Q.value.connected||q.push("/position")});const y=U(()=>g.value.chainName?Mo(g.value.chainName):{}),so=async()=>{s.value.setCurrentPositionLoading(!0);const l=q.currentRoute.value.query.token||"",d=q.currentRoute.value.query.collect||"",h=q.currentRoute.value.query.pos||"";g.value.chainName==="Aptos"?l&&d&&(V.value=d,W.value=q.currentRoute.value.query.address,M.value=l,s.value.setCurrentPositionInfo(W.value,V.value,M.value,g.value.chainName),n.value=s.value.currentPositionInfo):h&&(V.value=d,W.value=q.currentRoute.value.query.address,M.value=l,s.value.setCurrentPositionInfo(W.value,V.value,M.value,g.value.chainName,h),n.value=s.value.currentPositionInfo)};Z(()=>s.value.addressLpTokens,l=>{Y(l)||so()},{immediate:!0}),Z(()=>s.value.currentPositionInfo,l=>{l&&(n.value=s.value.currentPositionInfo,c.value=n.value.token_a,p.value=n.value.token_b,co({value:N.value/100}),console.log(n.value,"  positionInfo.valuepositionInfo.value"))});const N=r(50),k=r(0),_=r(0),mo=r(0),vo=U(()=>K.slippage);Z(N,Jo((l,d)=>{Number(l)>100?N.value=100:l&&n.value&&(N.value=l,co({value:N.value/100}))},300)),Z(vo,l=>{l&&n.value&&co({value:N.value/100})});const co=l=>{var T,B;const d=n.value.token_a.decimals,h=n.value.token_b.decimals,P=n.value.tick_lower_index,$=n.value.tick_upper_index,z=go.tickIndexToSqrtPriceX64(P),G=go.tickIndexToSqrtPriceX64($);mo.value=n.value.liquidity*Number(l.value);const R=Xo.getCoinAmountFromLiquidity(new po(mo.value),new po(n.value.current_sqrt_price),z,G,!0),O=Number(R.coinA.toString())/Math.pow(10,d),j=Number(R.coinB.toString())/Math.pow(10,h);console.log(O,j,"amountA121212"),k.value=O,_.value=j;const a=(T=s.value.RATES[n.value.token_a.address])==null?void 0:T.price,i=(B=s.value.RATES[n.value.token_b.address])==null?void 0:B.price;console.log(k.value,a,"fromCoinAmount.value"),eo.value=Number(k.value*a)<.01?Number(k.value*a)===0?"0":"<0.01":f(k.value*a,2),no.value=Number(_.value*i)<.01?Number(_.value*i)===0?"0":"<0.01":f(_.value*i,2);const S=x.minus(Number(n.value.amountA),Number(k.value))*a;u.value=Number(S)<.01?Number(S)===0?"0":"<0.01":f(S,2);const m=x.minus(Number(n.value.amountB),Number(_.value))*i;X.value=Number(m)<.01?Number(m)===0?"0":"<0.01":f(m,2);const w=Number(_o(S,2))+Number(_o(m,2));ro.value=Number(w)<.01?Number(w)===0?"0":"<0.01":f(w,2)},{setIsShowSuccess:So,setIsShowRejected:ho,setIsShowWaiting:io,setTransactionDesc:To,setTransactionTxid:Io,setPositiomNum:rn,setTransactionDescText:Co}=K,Oo=async()=>{var d,h,P,$,z,G,R,O,j;J.value=!0,Io(""),To(o("tips.removeLiquidiyText",{from:f(k.value,c.value.decimals)==0?"":`${I(k.value,c.value.decimals)} ${c.value.symbol}`,and:f(k.value,c.value.decimals)==0||f(_.value,p.value.decimals)==0?"":"and",to:f(_.value,p.value.decimals)==0?"":`${I(_.value,p.value.decimals)} ${p.value.symbol}`})),io(!0);const l=A.value&&A.value.length>0?o("modal.removeLiquidityText1"):o("modal.removeLiquidityText2");Co(l);try{let a={};a={pool:{...n.value.poolInfo,coinA:n.value.token_a,coinB:n.value.token_b},coinTypeA:n.value.poolInfo.coinTypeA,coinTypeB:n.value.poolInfo.coinTypeB,position:n.value,delta_liquidity:new po(wo(mo.value,0)),slippage:Number(vo.value),rewards_num:A.value.length};const i=A.value;console.log(A,"===>pendingRewarderArr"),a.coinTypeC=i[0]?i[0].coin_address:"",a.coinTypeD=i[1]?i[1].coin_address:"",a.coinTypeE=i[2]?i[2].coin_address:"",console.log(a,"===>params");const S=await y.value.getRemoveLiquidityTransactionPayload(a);let m;if(g.value.chainName==="Aptos")m=await Q.value.currentWallet.signAndSubmitTransaction(S);else{const w=await Q.value.currentWallet.signAndExecuteTransactionBlock(S);m=y.value.handleTx(w),console.log("0331###remove###tx####",m)}if(m&&m.hash){Io(m.hash),io(!1),So(!0);const w={title:o("common.removeLiquidity"),desc:"",hash:m.hash,sender:Q.value.address,chainName:g.value.chainName,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${(d=c.value)==null?void 0:d.symbol}`,numa:`+ ${k.value}`,logoa:s.value.tokensObj&&c.value&&c.value.address&&s.value.tokensObj[c.value.address]&&s.value.tokensObj[c.value.address].logoURI,tokenb:`${(h=p.value)==null?void 0:h.symbol}`,numb:`+ ${_.value}`,logob:s.value.tokensObj&&p.value&&p.value.address&&s.value.tokensObj[p.value.address]&&s.value.tokensObj[p.value.address].logoURI},text:`Withdraw ${k.value} ${(P=c.value)==null?void 0:P.symbol} and ${_.value} ${($=p.value)==null?void 0:$.symbol}`};g.value.chainName!=="Aptos"&&(w.res=m.res),y.value.showTransitionPending(w);const T=await y.value.watchTransaction(w);if(A.value&&A.value.length>0&&(Number((z=i[0])==null?void 0:z.amount)!==0||a.coinTypeD&&Number((G=i[1])==null?void 0:G.amount)!==0||a.coinTypeE&&Number((R=i[2])==null?void 0:R.amount)!==0)){const B={title:o("common.removeLiquidity"),desc:"",hash:m.hash,tit:"Bonus Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:i[0].symbol,numa:`+ ${Number(i[0].amount)}`,logoa:s.value.tokensObj&&i[0]&&i[0].address&&s.value.tokensObj[i[0].address]&&s.value.tokensObj[i[0].address].logoURI,tokenb:a.coinTypeD?i[1].symbol:"",numb:a.coinTypeD?`+ ${Number(i[1].amount)}`:"",logob:a.coinTypeD?s.value.tokensObj&&i[1]&&i[1].address&&s.value.tokensObj[i[1].address]&&s.value.tokensObj[i[1].address].logoURI:"",tokenc:a.coinTypeE?i[2].symbol:"",numc:a.coinTypeE?`+ ${Number(i[2].amount)}`:"",logoc:a.coinTypeE?s.value.tokensObj&&i[2]&&i[2].address&&s.value.tokensObj[i[2].address]&&s.value.tokensObj[i[2].address].logoURI:""},text:`Withdraw ${k.value} ${(O=c.value)==null?void 0:O.symbol} and ${_.value} ${(j=p.value)==null?void 0:j.symbol}`},H=await y.value.setTransations(B);console.log("9999transitionStatusFees",T,H)}if(I(n.value.feeOwedA,n.value.token_a.decimals)!==0||I(n.value.feeOwedB,n.value.token_b.decimals)!==0){const B={title:"Claim",desc:"",hash:m.hash,chainName:g.value.chainName,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${n.value.token_a.symbol}`,numa:f(n.value.feeOwedA,n.value.token_a.decimals)==0?"":`+ ${I(n.value.feeOwedA,n.value.token_a.decimals)}`,logoa:f(n.value.feeOwedA,n.value.token_a.decimals)==0?"":s.value.tokensObj&&n.value&&n.value.token_a.address&&s.value.tokensObj[n.value.token_a.address]&&s.value.tokensObj[n.value.token_a.address].logoURI,tokenb:`${n.value.token_b.symbol}`,numb:f(n.value.feeOwedB,n.value.token_b.decimals)==0?"":`+ ${I(n.value.feeOwedB,n.value.token_b.decimals)}`,logob:f(n.value.feeOwedB,n.value.token_b.decimals)==0?"":s.value.tokensObj&&n.value&&n.value.token_b.address&&s.value.tokensObj[n.value.token_b.address]&&s.value.tokensObj[n.value.token_b.address].logoURI}},H=await y.value.setTransations(B);console.log("9999transitionStatusFees",T,H)}T&&(setTimeout(()=>{so()},3e3),setTimeout(()=>{so()},6e3),Number(N.value)==100&&q.push("/position"))}else io(!1),ho(!0);J.value=!1}catch(a){console.log("Remove error",a),J.value=!1,io(!1),ho(!0)}},jo=U(()=>s.value.tokensObj&&c.value.address&&s.value.tokensObj[c.value.address]&&s.value.tokensObj[c.value.address].logoURI),Bo=U(()=>s.value.tokensObj&&p.value.address&&s.value.tokensObj[p.value.address]&&s.value.tokensObj[p.value.address].logoURI),qo=r(0),A=r([]);return Z(()=>[n.value,s.value.addressLpTokens,s.value.newTokenObj,s.value.RATES],async([l,d,h,P])=>{if(!Y(l)&&!Y(d)&&!Y(h)&&!Y(P)){const $=d[l.poolAddress];console.log($,"===>pool");const z=await y.value.getTickDataByIndex($.ticks_handle,Number(l.tick_lower_index)),G=await y.value.getTickDataByIndex($.ticks_handle,Number(l.tick_upper_index));let R={};g.value.chainName==="Aptos"?R=await y.value.getPosRewardersAmount({poolAddress:l.poolAddress,positionName:l.tokenName,tickLowerData:z,tickUpperData:G}):R=await y.value.getPosRewardersAmount({poolAddress:l.poolAddress,pos:l.pos_object_id,positionHandle:$.positions_handle});const O=[];let j=0;R.forEach((a,i)=>{if(n.value.poolInfo[`rewarder_display${i+1}`]){const S=h[a.coin_address].decimals,m=h[a.coin_address],w=Number(a.amount_owed.toString())>99999999999999?0:Number(a.amount_owed.toString());console.log(a.amount_owed.toString(),"===>element.amount_owed.toString()");const T=w/Math.pow(10,S),B=P[a.coin_address].price,H=T*B;j+=H,O.push({...a,...m,amount:T,amountUSD:H})}}),A.value=O,qo.value=Number(wo(j,2))}},{immediate:!0}),{removeAmountARates:u,removeAmountBRates:X,removeAmountRates:ro,receiveAmountARates:eo,receiveAmountBRates:no,showNum:I,fromCoinUrl:jo,toCoinUrl:Bo,precision:x,addCommom:f,loading:J,wallet:Q,toRemove:Oo,fromCoinAmount:k,toCoinAmount:_,pools:s,refresh:oo,amountArr:lo,sliderVal:N,positionInfo:n,slippage:vo,importIcon:F,clickRefresh:ko,isShowSwapSetting:bo,pendingRewarderArr:A,changeValue:$o}}});const ao=o=>(ie("data-v-9c085dde"),o=o(),te(),o),le={class:"remove-liquidity"},ue={class:"remove-liquidity-top"},re={class:"remove-title"},de={class:"right title-right"},me=ao(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1)),ve=ao(()=>e("use",{"xlink:href":"#icon-icon-refresh"},null,-1)),ce=[ve],pe={class:"remove-liquidity-center"},fe={class:"top"},be={class:"left"},ke={class:"right"},he={class:"fee"},Ie={class:"bottom"},ge={class:"add-amount"},_e={class:"add-amount-header"},we={class:"amount-list"},ye=["onClick"],Ne={class:"slider-box"},Ae={class:"receive"},$e={class:"receiveTit"},Re={class:"item"},Se={class:"left"},Te=["src"],Ce={class:"right"},Oe={class:"item"},je={class:"left"},Be=["src"],qe={class:"right"},Pe={class:"remove-liquidity-bottom-box"},Ue={class:"induction remove-liquidity-bottom"},Le={class:"item"},De={class:"induction-text"},Ee={class:"induction-value"},Fe=["src"],Ve=ao(()=>e("div",{class:"induction-text"},null,-1)),We={class:"induction-value"},Me=["src"],Xe={class:"induction-text"},ze={class:"induction-value"},Ge=["src"],He=ao(()=>e("svg",{"aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-Remove"})],-1)),Je={key:0,class:"receive"},Ke={class:"receiveTit"},Qe={class:"left"},Ye={class:"right"},Ze={class:"item"},xe={class:"left"},on=["src"],en={class:"right"},nn={class:"item"},sn={class:"left"},tn=["src"],an={class:"right"},ln={class:"loading-global"};function un(o,v,bo,J,oo,ko){const lo=Po,K=Uo,g=Lo,uo=oe,V=ee,W=ne,M=Do,eo=Eo,no=se;return C(),L("div",le,[D(lo),e("div",ue,[e("div",re,t(o.$t("common.removeLiquidity")),1),e("div",de,[e("div",{class:"slippage-icon",onClick:v[0]||(v[0]=u=>o.isShowSwapSetting=!0)},[me,e("span",null,t(o.slippage)+"%",1)]),(C(),L("svg",{"aria-hidden":"true",class:fo(o.refresh?"refresh refresh-icon ":"refresh-icon"),onClick:v[1]||(v[1]=(...u)=>o.clickRefresh&&o.clickRefresh(...u))},ce,2))])]),e("div",pe,[e("div",fe,[e("div",be,[o.positionInfo?(C(),yo(K,{key:0,"from-coin":o.positionInfo.token_a,"to-coin":o.positionInfo.token_b},null,8,["from-coin","to-coin"])):to("",!0),e("div",ke,[e("div",he,t(o.positionInfo.fee*100)+"%",1)])]),D(g,{"current-status":o.positionInfo.currentStatus||""},null,8,["current-status"])]),e("div",Ie,[e("div",ge,[e("div",_e,[e("span",null,t(o.$t("common.amount")),1),e("div",we,[(C(!0),L(No,null,Ao(o.amountArr,(u,X)=>(C(),L("div",{key:X,class:fo(["amount-item",o.sliderVal==u.value?"amount-item-active":""]),onClick:ro=>o.sliderVal=u.value},t(u.name),11,ye))),128))])]),e("div",Ne,[D(uo,{value:o.sliderVal,"onUpdate:value":v[2]||(v[2]=u=>o.sliderVal=u),suffix:"%",onChange:v[3]||(v[3]=u=>o.changeValue(u.target.value))},null,8,["value"]),D(V,{value:o.sliderVal,"onUpdate:value":v[4]||(v[4]=u=>o.sliderVal=u)},null,8,["value"])])])])]),e("div",Ae,[e("div",$e,t(o.$t("newAdd.receive")),1),e("div",Re,[e("div",Se,[e("img",{src:o.fromCoinUrl||("importIcon"in o?o.importIcon:b(F))(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,Te),e("span",null,t(("showNum"in o?o.showNum:b(I))(o.fromCoinAmount,o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals)),1),E(" "+t(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol)+" "+t(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.labels&&o.positionInfo.token_a.labels[0]?`(${o.positionInfo.token_a.labels[0]})`:""),1)]),e("div",Ce,"≈ $"+t(o.receiveAmountARates),1)]),e("div",Oe,[e("div",je,[e("img",{src:o.toCoinUrl||("importIcon"in o?o.importIcon:b(F))(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,Be),e("span",null,t(("showNum"in o?o.showNum:b(I))(o.toCoinAmount,o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals)),1),E(" "+t(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol)+" "+t(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.labels&&o.positionInfo.token_b.labels[0]?`(${o.positionInfo.token_b.labels[0]})`:""),1)]),e("div",qe,"≈ $"+t(o.receiveAmountBRates),1)])]),e("div",Pe,[e("div",Ue,[e("div",Le,[e("div",De,t(o.$t("common.fees")),1),e("div",Ee,[e("img",{src:o.fromCoinUrl||("importIcon"in o?o.importIcon:b(F))(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,Fe),E(" "+t(("showNum"in o?o.showNum:b(I))(o.positionInfo&&o.positionInfo.feeOwedA,o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals))+" ",1),e("span",null,t(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol),1)])]),e("div",{class:fo(o.pendingRewarderArr.length>0?"item item-boder":"item")},[Ve,e("div",We,[e("img",{src:o.toCoinUrl||("importIcon"in o?o.importIcon:b(F))(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,Me),E(" "+t(("showNum"in o?o.showNum:b(I))(o.positionInfo&&o.positionInfo.feeOwedB,o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals))+" ",1),e("span",null,t(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol),1)])],2),o.positionInfo.is_display_rewarder?(C(!0),L(No,{key:0},Ao(o.pendingRewarderArr,(u,X)=>(C(),L("div",{key:u,class:"item"},[e("div",Xe,t(X==0?o.$t("common.rewards"):""),1),e("div",ze,[e("img",{src:u.logoURI},null,8,Ge),E(" "+t(u.amount>1e-6?u.amount:u.amount===0?"0":"<0.000001")+" ",1),e("span",null,t(u.symbol),1)])]))),128)):to("",!0)])]),D(W,{disabled:o.wallet.connected?Number(o.sliderVal)==0||o.loading:!1,class:"remove-btn big-btn",onClick:v[5]||(v[5]=u=>o.wallet.connected?o.toRemove():o.wallet.setIsShowWalletModal(!0))},{default:Yo(()=>[He,e("span",null,t(o.wallet.connected?o.$t("button.remove"):o.$t("button.connectWallet")),1)]),_:1},8,["disabled"]),D(M),o.sliderVal<100?(C(),L("div",Je,[e("div",Ke,[e("div",Qe,t(o.$t("newAdd.remainingPosition")),1),e("div",Ye,"$"+t(o.removeAmountRates),1)]),e("div",Ze,[e("div",xe,[e("img",{src:o.fromCoinUrl||("importIcon"in o?o.importIcon:b(F))(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,on),e("span",null,t(("showNum"in o?o.showNum:b(I))(("precision"in o?o.precision:b(x)).minus(Number(o.positionInfo.amountA),Number(o.fromCoinAmount)),o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals)),1),E(" "+t(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol)+" "+t(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.labels&&o.positionInfo.token_a.labels[0]?`(${o.positionInfo.token_a.labels[0]})`:""),1)]),e("div",en,"≈ $"+t(o.removeAmountARates),1)]),e("div",nn,[e("div",sn,[e("img",{src:o.toCoinUrl||("importIcon"in o?o.importIcon:b(F))(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,tn),e("span",null,t(("showNum"in o?o.showNum:b(I))(("precision"in o?o.precision:b(x)).minus(Number(o.positionInfo.amountB),Number(o.toCoinAmount)),o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals)),1),E(" "+t(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol)+" "+t(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.labels&&o.positionInfo.token_b.labels[0]?`(${o.positionInfo.token_b.labels[0]})`:""),1)]),e("div",an,"≈ $"+t(o.removeAmountBRates),1)])])):to("",!0),o.isShowSwapSetting?(C(),yo(eo,{key:1,onOnClose:v[6]||(v[6]=u=>o.isShowSwapSetting=!1)})):to("",!0),Zo(e("div",ln,[D(no)],512),[[xo,o.pools.currentPositionLoading]])])}const _n=Qo(ae,[["render",un],["__scopeId","data-v-9c085dde"]]);export{_n as default};
